<%= render "shared/dashboard" %>
<div  style="margin-left: 25%; padding:86px 28px; height:1000px" >
  <center><h2>RECENT ACTIVITY</h2></center>
  <br>
  <div class="mb-5 mt-4">
    <div class="text-center float-left">
      <p>Contributing to <span style="color: #7C61FF; font-size: 25px;"><%= @user.teams.count %></span> Teams</p>
    </div>
    <div class="text-center float-left">
      <p>Part of <span style="color: #7C61FF; font-size: 25px;"><%= @user.projects.count %></span> Projects</p>
    </div>
    <div class="text-center float-left">
      <p>Access to <span style="color: #7C61FF; font-size: 25px;"><%= @user.documents.count %></span> Documents</p>
    </div>
  </div>
  ​
  <br>
  ​
  <%= simple_form_for :search, url: "/users/#{current_user.id}/recent", method: :get do |f| %>
    <div class="search-form-control form-group mt-5">
      <input class="form-control string required" type="text" name="search[query]" id="search_query" placeholder="Filter by name, date, project, team, keyword, etc." autocomplete="off"/>
      <button name="button" type="submit" class="btn btn-flat">
        <i class="fas fa-search"></i> Search
      </button>
    </div>
  <% end %>

  <br>

  <% if @user.documents.empty? && @user.projects.empty? && @user.teams.empty? %>
    <center><h1>No history</h1></center>
  <% else %>
    <% if params[:search].present? %>
      <div id="timeline-content">
        <ul class="timeline">
          <% @teams.each do |team| %>
            <li><%= team.team_name %></li>
          <% end %>
          <% @documents.each do |document| %>
            <li><%= document.file_name %></li>
          <% end %>
          <% @projects.each do |project| %>
            <li><%= project.project_name %></li>
          <% end %>
        </ul>
      </div>
    <% else %>
    <div id="timeline-content">
      <ul class="timeline">
        <% if @user.documents.present? %>
          <li class="event" data-date="<%= @user.documents.last.updated_at.to_time.strftime('%b-%d-%Y at %l:%M') %>">
            <h3>Edited <%= @user.documents.last.file_name %></h3>
            <p>edited file size</p>
          </li>
          <li class="event" data-date="<%= @user.documents.last.created_at.to_time.strftime('%b-%d-%Y at %l:%M') %>">
            <h3>Added <%= @user.documents.last.file_name %></h3>
            <p>added to <%=  @user.documents.last.project.project_name %></p>
          </li>
        <% end %>
        <% if @user.projects.present? %>
          <li class="event" id="date" data-date="<%= @user.projects.last.created_at.to_time.strftime('%b-%d-%Y at %l:%M') %>">
            <h3>Created <%= @user.projects.last.project_name %></h3>
            <p>assigned to <%=  Team.find_by(params[:id]).team_name %></p>
          </li>
        ​<% end %>
        <% if @user.teams.present? %>
          <li class="event" data-date="<%= @user.teams.last.created_at.to_time.strftime('%b-%d-%Y at %l:%M') %>">
            <h3>Joined <%= @user.teams.last.team_name %></h3>
            <p>This team has <%= @user.teams.last.users.count %> contributors</p> <p>This is your <em><strong><%= @user.teams.count.ordinalize %></strong></em> team!</p>
          </li>
        <% end %>
      </ul>
    </div>
    <% end %>
  <% end %>
</div>
